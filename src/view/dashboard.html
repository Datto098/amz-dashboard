<!DOCTYPE html>
<html lang="en">
	<head>
		<!-- Inter font Google Fonts -->
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
			rel="stylesheet"
		/>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Product Dashboard</title>
		<link rel="stylesheet" href="./dashboard.css" />
	</head>
	<body>
		<div class="main-layout">
			<div class="content-layout">
				<!-- SIDEBAR -->
				<aside id="sidebar" class="sidebar">
					<!-- Stats Section -->
					<div class="stats-section">
						<!-- <h2 class="stats-heading">Product Statistics</h2> -->
						<div class="stats-container">
							<!-- <div class="stat-item">
							<span class="stat-label">Total Products:</span>
							<span class="stat-value" id="total-products-count"
								>0</span
							>
						</div> -->
							<div class="stat-item">
								<span class="stat-label"
									>Số sản phẩm đang hiển thị:
								</span>
								<span
									class="stat-value"
									id="showing-products-count"
									>0</span
								>
							</div>
							<!-- <div class="stat-item">
							<span class="stat-label">With Price:</span>
							<span class="stat-value" id="with-price-count"
								>0</span
							>
						</div> -->
							<!-- <div class="stat-item">
							<span class="stat-label">With Rating:</span>
							<span class="stat-value" id="with-rating-count"
								>0</span
							>
						</div> -->
						</div>
					</div>

					<div class="filter-section">
						<h2 class="filter-heading">Sellers</h2>
						<div id="sellerFilters" class="filter-options"></div>
					</div>
					<div class="filter-section">
						<h2 class="filter-heading">Categories</h2>
						<div id="categoryFilters" class="filter-options"></div>
					</div>
					<div class="filter-section">
						<h2 class="filter-heading">Source</h2>
						<div id="sourceFilters" class="filter-options"></div>
					</div>
				</aside>
				<!-- MAIN -->
				<main class="main-content">
					<div class="container">
						<!-- FILTER BAR -->
						<div id="filter-bar" class="filter-bar">
							<div class="filter-toolbar">
								<!-- Search Input -->
								<div class="search-section">
									<input
										type="text"
										id="searchInput"
										class="search-input"
										placeholder="Search products..."
									/>
									<button
										onclick="filterProducts()"
										class="search-btn"
									>
										<svg
											width="16"
											height="16"
											viewBox="0 0 24 24"
											fill="none"
											stroke="currentColor"
											stroke-width="2"
										>
											<circle
												cx="11"
												cy="11"
												r="8"
											></circle>
											<path d="m21 21-4.35-4.35"></path>
										</svg>
									</button>
								</div>

								<!-- Sort Dropdown -->
								<div class="dropdown">
									<button
										class="dropdown-btn"
										onclick="toggleDropdown('sort')"
									>
										<span id="sortText">Sort by</span>
										<svg
											width="12"
											height="12"
											viewBox="0 0 24 24"
											fill="none"
											stroke="currentColor"
											stroke-width="2"
										>
											<polyline
												points="6,9 12,15 18,9"
											></polyline>
										</svg>
									</button>
									<div
										id="sortDropdown"
										class="dropdown-content"
									>
										<div
											class="dropdown-item"
											onclick="selectSort('')"
										>
											-- Select --
										</div>
										<div
											class="dropdown-item"
											onclick="selectSort('price_asc')"
										>
											Price: Low to High
										</div>
										<div
											class="dropdown-item"
											onclick="selectSort('price_desc')"
										>
											Price: High to Low
										</div>
										<div
											class="dropdown-item"
											onclick="selectSort('date_asc')"
										>
											Date: Oldest to Newest
										</div>
										<div
											class="dropdown-item"
											onclick="selectSort('date_desc')"
										>
											Date: Newest to Oldest
										</div>
										<div
											class="dropdown-item"
											onclick="selectSort('bought_desc')"
										>
											Bought: High to Low
										</div>
										<div
											class="dropdown-item"
											onclick="selectSort('bought_asc')"
										>
											Bought: Low to High
										</div>
									</div>
								</div>

								<!-- Filter Dropdown -->
								<div class="dropdown">
									<button
										class="dropdown-btn"
										onclick="toggleDropdown('filter')"
									>
										<span>Filter</span>
										<svg
											width="12"
											height="12"
											viewBox="0 0 24 24"
											fill="none"
											stroke="currentColor"
											stroke-width="2"
										>
											<polyline
												points="6,9 12,15 18,9"
											></polyline>
										</svg>
									</button>
									<div
										id="filterDropdown"
										class="dropdown-content filter-panel"
									>
										<div class="filter-section">
											<h4>Price Range</h4>
											<div class="filter-row">
												<input
													type="number"
													id="minPrice"
													placeholder="Min"
												/>
												<span>-</span>
												<input
													type="number"
													id="maxPrice"
													placeholder="Max"
												/>
											</div>
										</div>
										<div class="filter-section">
											<h4>Date Range</h4>
											<div class="filter-row">
												<input
													type="date"
													id="startDate"
												/>
												<span>to</span>
												<input
													type="date"
													id="endDate"
												/>
											</div>
										</div>
										<div class="filter-section">
											<h4>Options</h4>
											<label class="checkbox-label">
												<input
													type="checkbox"
													id="boughtInPastMonth"
												/>
												<span
													>Bought in past month</span
												>
											</label>
										</div>
										<div class="filter-actions">
											<button
												onclick="resetFilters()"
												class="reset-btn"
											>
												Reset
											</button>
											<button
												onclick="applyFilters()"
												class="apply-btn"
											>
												Apply
											</button>
										</div>
									</div>
								</div>

								<!-- View Toggle -->
								<div class="view-toggle">
									<button
										id="gridBtn"
										class="view-btn active"
										onclick="switchView('grid')"
									>
										<svg
											width="16"
											height="16"
											viewBox="0 0 24 24"
											fill="none"
											stroke="currentColor"
											stroke-width="2"
										>
											<rect
												x="3"
												y="3"
												width="7"
												height="7"
											></rect>
											<rect
												x="14"
												y="3"
												width="7"
												height="7"
											></rect>
											<rect
												x="14"
												y="14"
												width="7"
												height="7"
											></rect>
											<rect
												x="3"
												y="14"
												width="7"
												height="7"
											></rect>
										</svg>
										Grid
									</button>
									<button
										id="tableBtn"
										class="view-btn"
										onclick="switchView('table')"
									>
										<svg
											width="16"
											height="16"
											viewBox="0 0 24 24"
											fill="none"
											stroke="currentColor"
											stroke-width="2"
										>
											<path
												d="M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18"
											></path>
										</svg>
										Table
									</button>
								</div>
							</div>
						</div>

						<!-- Render here -->
						<div id="productList" class="product-list"></div>
						<div id="productTable" style="display: none"></div>
					</div>
				</main>
			</div>
		</div>
		<!-- Confirmation Modal -->
		<div id="deleteModal" class="modal">
			<div class="modal-content">
				<div class="modal-header">
					<h2>Confirm Deletion</h2>
					<span class="close-modal">&times;</span>
				</div>
				<div class="modal-body">
					<p>Are you sure you want to delete this product?</p>
					<p id="deleteProductName" style="font-weight: bold"></p>
				</div>
				<div class="modal-footer">
					<button
						class="modal-btn modal-btn-cancel"
						id="cancelDelete"
					>
						Cancel
					</button>
					<button
						class="modal-btn modal-btn-delete"
						id="confirmDelete"
					>
						Delete
					</button>
				</div>
			</div>
		</div>
	</body>
	<script>
		// Load environment variables from server
		fetch('/api/config')
			.then((response) => response.json())
			.then((config) => {
				window.API_BASE_URL = config.API_BASE_URL || '';
				console.log('Config loaded:', config);
			})
			.catch((error) => {
				console.error('Failed to load config:', error);
				window.API_BASE_URL = '';
			});
	</script>
	<script src="./dashboard.js"></script>
</html>
